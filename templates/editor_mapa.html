{% extends "base.html" %}

{% block title %}{% if mapa %}Modificar {{ mapa.nombre }}{% else %}Crear Mapa{% endif %} - Sistema de Mapas Querétaro{% endblock %}

{% block content %}
<div class="container">
    <header class="page-header">
        <a href="{{ url_for('main.index') }}" class="btn btn-back">← Volver</a>
        <div class="header-center">
            <input type="text" id="nombre-mapa" placeholder="Nombre del indicador" class="map-name-input" value="{{ mapa.nombre if mapa else '' }}">
        </div>
        <button onclick="guardarMapa()" class="btn btn-success" id="btn-guardar">
            {% if mapa %}Guardar Cambios{% else %}Guardar Mapa{% endif %}
        </button>
    </header>
    
    <main class="create-content">
        <section class="map-edit-section">
            <h2>Mapa en Construcción</h2>
            <div class="map-edit-container">
                <div id="mapa-edicion" data-mapa-id="{{ mapa.id if mapa else '' }}">
                    {% include 'components/mapa_svg.html' %}
                </div>
                <div id="municipio-status">
                    <p>Selecciona un municipio para editarlo</p>
                </div>
            </div>
        </section>
        
        <aside class="edit-sidebar">
            <div class="config-panel">
                <h3>Configurar Municipio</h3>
                <form id="form-municipio">
                    <input type="hidden" id="municipio-actual" value="">
                    
                    <div class="form-group">
                        <label for="color-municipio">Color:</label>
                        <input type="color" id="color-municipio" value="#ffffff" class="color-input">
                    </div>
                    
                    <div class="form-group">
                        <label for="info-municipio">Información:</label>
                        <textarea id="info-municipio" rows="4" placeholder="Escribe la información del municipio" class="info-textarea"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="imagen-municipio">Imagen:</label>
                        <input type="file" id="imagen-municipio" accept="image/*" class="file-input">
                        <div id="preview-imagen"></div>
                    </div>
                    
                    <button type="button" onclick="aplicarConfiguracion()" class="btn btn-apply">
                        Aplicar
                    </button>
                </form>
            </div>
            
            <div class="table-generator">
                <h3>Generar Tabla</h3>
                <div id="tabla-container">
                    </div>
            </div>
        </aside>
    </main>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/editor_mapa.js') }}"></script>
{% endblock %}